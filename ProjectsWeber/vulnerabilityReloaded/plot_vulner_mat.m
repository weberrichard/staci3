close all; 
clear;

addpath('../../Plot');

% cases= ["villasor","ferto","sanchegy","buk","lovo","nagycenk","vashegy","varis","becsidomb","tomalom",...
%     "szakov","kohegy","harka","pozsonyiut","sopronkovesd","dudlesz","ivan","agyagosszergeny","kofejto","simasag",...
%     "acsad","csaford","nagylozs","balf","csapod","und","rojtokmuzsaj","brennberg","pusztacsalad","kutyahegy",...
%     "nyarliget","meszlen","fertoujlak","gorbehalom","tozeggyarmajor","ebergoc","csillahegy","jerevan","gloriette",...
%     "ohermes","ujhermes"];

% cases= ["villasor_mat","ferto_mat","sanchegy_mat","buk_mat","lovo_mat","nagycenk_mat","vashegy_mat","varis_mat","becsidomb_mat","tomalom_mat",...
%     "szakov_mat","kohegy_mat","harka_mat","pozsonyiut_mat","sopronkovesd_mat","dudlesz_mat","ivan_mat","agyagosszergeny_mat","kofejto_mat","simasag_mat",...
%     "acsad_mat","csaford_mat","nagylozs_mat","balf_mat","csapod_mat","und_mat","rojtokmuzsaj_mat","brennberg_mat","pusztacsalad_mat","kutyahegy_mat",...
%     "nyarliget_mat","meszlen_mat","fertoujlak_mat","gorbehalom_mat","tozeggyarmajor_mat","ebergoc_mat","csillahegy_mat","jerevan_mat","gloriette_mat",...
%     "ohermes_mat","ujhermes_mat"];

cases= ["villasor_mat","villasor","sanchegy_mat","sanchegy","vashegy_mat","vashegy","varis_mat","varis",...
    "becsidomb_mat","becsidomb","tomalom_mat","tomalom",...
    "dudlesz_mat","dudlesz","balf_mat","balf","brennberg_mat","brennberg"];

% cases = ["ky1","ky2","ky3","ky4","ky5","ky6","ky7","ky8","ky9","ky10","ky11","ky12","ky13","ky14"];

idx = 1:10;


%blackBody, blackBodyExt, cividis, coolWarmBent, coolWarmSmooth, inferno, jet, kindlmann, kindlmannExt, magma, plasma, viridis
%discrete: lines, prism
% colorMapName = 'grayscale'; 
colorMapName = 'plasma';
colorMapName2 = 'grayscale';
colorMap = importdata(['../../Plot/ColorMaps/',colorMapName,'.col']);
colorMap2 = importdata(['../../Plot/ColorMaps/',colorMapName2,'.col']);

fig = figure('Position',[200 200 900 600]);
hold on; grid on;
for I=idx(1:2:end)
    data{1} = importdata(join(['Network Data/',cases(I),'/vulner_orig_rand.txt'],''));
    data{2} = importdata(join(['Network Data/',cases(I+1),'/vulner_orig_rand.txt'],''));
%     data{1} = importdata(join(['Network Data/',cases(I),'/vulner_N.txt'],''));
%     data{3} = importdata(join(['Network Data/',cases(I),'/vulner_Nm1.txt'],''));
    set(gca,'XScale','log','YScale','log');
    for i=1:size(data,2)
        gammaBar = data{i};
        gammaBarNZ = gammaBar(gammaBar~=0);
        n = length(gammaBarNZ);
        if(n>100)
            r = round(log(n)/log(2)+1);
        else
            r = round(sqrt(n));
        end
        b = prctile(gammaBarNZ,(0:1/r:1)*100);
        x = (b(1:end-1)+b(2:end))/2;
    %     x = b(1:end-1);

        f = zeros(r,1);
        % frequency
        for j=1:r
            f(j) = length(gammaBarNZ(gammaBarNZ>=b(j) & gammaBarNZ<b(j+1)));
        end
        f = f/sum(f); % relative frequency

        y = f./diff(b');
    
        if(mod(i,2)==0)
            colr = min(1,max(0,interp1(colorMap(:,1),colorMap(:,2),(I-1)/size(idx,2),'spline')));
            colg = min(1,max(0,interp1(colorMap(:,1),colorMap(:,3),(I-1)/size(idx,2),'spline')));
            colb = min(1,max(0,interp1(colorMap(:,1),colorMap(:,4),(I-1)/size(idx,2),'spline')));
        else
            colr = min(1,max(0,interp1(colorMap2(:,1),colorMap2(:,2),(I-1)/size(idx,2),'spline')));
            colg = min(1,max(0,interp1(colorMap2(:,1),colorMap2(:,3),(I-1)/size(idx,2),'spline')));
            colb = min(1,max(0,interp1(colorMap2(:,1),colorMap2(:,4),(I-1)/size(idx,2),'spline')));
        end

        if(mod(I,5) == 0)
            marker = 'x';
        elseif(mod(I,5) == 1)
            marker = 'o';
        elseif(mod(I,5) == 2)
            marker = '+';
        elseif(mod(I,5) == 3)
            marker = '*';
        elseif(mod(I,5) == 4)
            marker = 'p';
        end
        plot(x,y,marker,'color',[colr,colg,colb],'linewidth',1.5);

    end
end

xlabel('Lokális sebezhetőség [-]','fontsize',14);
ylabel('Valószínűségi sűrűség [-]','fontsize',14);
% legend(cases(idx));
set(gca,'FontSize',14);
% xlabel('Szegmens sebezhetĹ‘sĂ©g [-]','interpreter','latex','fontsize',14);
% ylabel('ValĂłszĂ­nĹ±sĂ©g sĹ±rĹ±sĂ©g [-]','interpreter','latex','fontsize',14);
xlim([1e-9,1e-1])
ylim([1e-1,1e8])
% set(gca,'Position',[100,100,600,400])
% legend('Eredeti','N szabĂˇly','N-1 szabĂˇly');

f=get(gca,'Children');
legend(f(end:-2:2),cases(idx(2:2:end)));

% set(gca,'FontSize',14);
% ColumnLegend(3,num2str(idx(:)));
% ColumnLegend(3,num2str(idx(:)),'location','southwest_sf');
% legend('Original','N rule','N-1 rule');
% rectangle('Position',[1.3e-9 1.9e-1 3.5e-7 5e3],'FaceColor',[1 1 1])
% txt1 = text(2e-8,3e3,'IvĂłvĂ­zhĂˇlĂłzat','FontSize',14,'HorizontalAlignment','center');
% txt2 = text(2e-8,1.2e3,'sorszĂˇm','FontSize',14,'HorizontalAlignment','center');
saveas(gca,'Plots/Vulner_mat.fig','fig');
saveas(gca,'Plots/Vulner_mat.png','png');
saveas(gca,'Plots/Vulner_mat.eps','epsc');

