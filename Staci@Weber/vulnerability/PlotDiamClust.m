clear;
close all;

cases= ["villasor","ferto","sanchegy","buk","lovo","nagycenk","vashegy","varis","becsidomb","tomalom",...
    "szakov","kohegy","harka","pozsonyiut","sopronkovesd","dudlesz","ivan","agyagosszergeny","kofejto","simasag",...
    "acsad","csaford","nagylozs","balf","csapod","und","rojtokmuzsaj","brennberg","pusztacsalad","kutyahegy",...
    "nyarliget","meszlen","fertoujlak","gorbehalom","tozeggyarmajor","ebergoc","csillahegy","jerevan","gloriette",...
    "alomhegy","ohermes","ujhermes"];


colorMapName = 'plasma';
colorMap = importdata(['../../Plot/ColorMaps/',colorMapName,'.txt']);

c_wdn = 0.0;
c_rand = 0.8;
c_bar = 0.4;


%  i | n_seg | diam | cluster |
% -----------------------------
M1 = [
 1 , 717, 42, 0.0156;
 2 , 461, 73, 0.0097;
 3 , 222, 34, 0.0183;
 4 , 143, 27, 0.0347;
 5 , 173, 60, 0.0099;
 6 , 142, 43, 0.0000;
 7 , 179, 38, 0.0181;
 8 , 226, 43, 0.0000;
 9 , 195, 24, 0.0000;
10 ,  65, 11, 0.0270;
11 ,  85, 34, 0.0000;
12 ,  57, 15, 0.0000;
13 ,  45, 13, 0.0309;
14 ,  74, 22, 0.0000;
15 ,  64, 19, 0.0571;
16 ,  47, 11, 0.0288;
17 ,  44, 15, 0.0405;
18 ,  63, 17, 0.0000;
19 ,  45, 11, 0.0000;
20 ,  41, 16, 0.0405;
21 ,  27, 13, 0.0000;
22 ,  38, 18, 0.0000;
23 ,  27,  7, 0.0508;
24 ,  12,  6, 0.0000;
25 ,  24, 11, 0.0000;
26 ,  29, 13, 0.0000;
27 ,  28, 13, 0.0000];

N = M1(:,2);
% NN = linspace(min(N),max(N),1000);
NN = logspace(log(min(N))/log(10),log(max(N))/log(10),100);
d = M1(:,3);
C = M1(:,4);

% diameter
d_rand = 2*sqrt(NN);
% d_rand = log(NN);
d_bar = log(NN)./log(log(NN));

% figure('Position',[100 100 900 600]);
figure();
grid on; hold on;
% title('Diameter');

[r,g,b] = color(c_wdn,colorMap);
plot(N,d,'x','color',[r,g,b],'linewidth',1.5,'markersize',8);

[r,g,b] = color(c_rand,colorMap);
plot(NN,d_rand,'color',[r,g,b],'linewidth',2.0);

[r,g,b] = color(c_bar,colorMap);
plot(NN,d_bar,'color',[r,g,b],'linewidth',2.0);

legend('WDNs','Random (2D)','Scale-free','fontsize',12,'location','northwest');
% set(gca,'XScale','log','YScale','log')
xlabel('Number of segments [-]','fontsize',14);
ylabel('Diameter [-]','fontsize',14);
set(gca,'FontSize',12);
saveas(gca,'Plots/Diameter.fig','fig');
saveas(gca,'Plots/Diameter.png','png');
saveas(gca,'Plots/Diameter.eps','epsc');

% clustering coeff
C_rand = 2.25./NN;
C_bar = 1/2*log(NN).^2./NN;

% figure('Position',[1000 100 900 600]);
figure();
grid on; hold on;
% title('Clustering coefficient');

[r,g,b] = color(c_wdn,colorMap);
plot(N,C,'x','color',[r,g,b],'linewidth',1.5,'markersize',8);

[r,g,b] = color(c_rand,colorMap);
plot(NN,C_rand,'color',[r,g,b],'linewidth',2.0);

[r,g,b] = color(c_bar,colorMap);
plot(NN,C_bar,'color',[r,g,b],'linewidth',2.0);

ylim([0,0.2]);
% set(gca,'XScale','log','YScale','log')
legend('WDNs','Random','Scale-free','fontsize',12);
xlabel('Number of segments [-]','fontsize',14);
ylabel('Clustering coefficient [-]','fontsize',14);
set(gca,'FontSize',12);
saveas(gca,'Plots/ClusteringCoef.fig','fig');
saveas(gca,'Plots/ClusteringCoef.png','png');
saveas(gca,'Plots/ClusteringCoef.eps','epsc');

function [r,g,b] = color(scal,colorMap)
    r = min(1,max(0,interp1(colorMap(:,1),colorMap(:,2),scal,'spline')));
    g = min(1,max(0,interp1(colorMap(:,1),colorMap(:,3),scal,'spline')));
    b = min(1,max(0,interp1(colorMap(:,1),colorMap(:,4),scal,'spline')));
end


